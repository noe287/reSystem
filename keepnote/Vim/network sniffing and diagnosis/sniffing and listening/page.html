<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Sniffing and Listening</title>
</head><body><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">SNIFFing </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">--------------------------------------------------------------------------------------------------------------- </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">tcpdump -vvv -i br0 ether proto 0x7380 </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">tcpdump -vvv -i wds1.2 ether proto 0x7380 </span></span><br/>
<span style="font-family: Calibri"><span style="font-size: 11pt"><br/>
</span></span><span style="font-family: Calibri"><span style="font-size: 11pt">tcpdump -vvv -i eth0 ether proto 0x7380 </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">  </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">Mcap sniffing from inside 4920 </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">--------------------------------------------------------------------------------------------------------------- </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">/mkap.4920 -i eth0 </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">nc 192.168.2.102 54321|wireshark -kSli - </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">iperf -s -u -B 224.0.22.2 </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">cat /proc/igmp_snoop_info </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">  </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">How to RUN on the device and PC or linux </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">--------------------------------------------------------------------------------------------------- </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">On 4920 </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">-------- </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">./tcpdump.4920 -i eth0 -w -| nc -l -p 9999 </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">  </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">On the PC </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">---------------------------------------------------------------- </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">nc 192.168.2.64 9999 &gt; dump.pcap </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">  </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">On the PC to read the dump.pcap </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">------------------------------------------------------------------ </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">tcpdump -r dump.pcap igmp or arp </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">  </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">or use wireshark or tshark </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">  </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">nc -l 9999|wireshark -kSli - </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">----------------------------------------------------------------------------- </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">Just FILE TRANSFER </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">----------------------------------------------------------------------------------------- </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">PC to Air4920 </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">------------------------------------------------------------------------------------------- </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">nc 192.168.2.77 9999 &gt; a.bin </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">nc -l 9999 &lt; tcpdump.4920 </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">  </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">--------------------------------------------------------------------------------------------------- </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">  </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">  </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">  </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">Air5760 as a wireless SNIFFER </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">------------------------------------------------------------------------------------------------------- </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">On the HOST PC while SUPERUSER: </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">------------------ </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">nc -l -p 9999 | wireshark -k -S -l -i - &amp; </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">  </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">On 5760 </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">------------------- </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">set_config wireless-1 channel 36 </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">wl -i wl1 monitor 3   </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">ifconfig radiotap1 up  </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">tcpdump -i radiotap1 -n -w - | nc 192.168.2.77 9999 &amp; </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">  </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">  </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">set_config wireless-0 channel 13 </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">wl -i wl0 monitor 3   </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">ifconfig radiotap0 up  </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">tcpdump -i radiotap0 -n -w - | nc 192.168.2.77 9999 &amp; </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">  </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">--------------------------------------------------------------------------------------------------- </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">  </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">PACKET TRACKING </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">------------------------------------------------------------------------------------------------------------ </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">cat /proc/net/packet  </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">sk       RefCnt Type Proto  Iface R Rmem   User   Inode </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">ce250400 3      2    0800   5     1 0      0      6580382 </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">ceeff800 3      3    886c   5     1 0      0      5130   </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">ceeff600 3      3    888e   5     1 0      0      5126   </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">ceeff400 3      3    888e   7     1 0      0      5125   </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">ceeff200 3      3    888e   5     1 0      0      5120   </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">cdb6b800 3      3    886c   5     1 0      0      5093   </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">cec72000 3      3    888e   5     1 0      0      5089   </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">ceccb200 3      3    888e   8     1 0      0      5088   </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">cdb55000 3      2    0806   5     1 122688 0      3458   </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">ce240c00 3      3    7379   5     1 0      0      1996   </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">cecc2e00 3      3    88d9   5     1 0      0      895    </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">ceea2000 3      3    7679   5     1 0      0      853    </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">cecc2000 3      3    7679   5     1 0      0      832    </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">cecc2a00 3      3    7679   5     1 0      0      831   </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">  </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">------------------------------------------------------------------------------------------------------------ </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">ls /proc/*/fd -al|grep 853 -B 10 </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">ls: /proc/25820/fd/3: cannot read link: No such file or directory </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">ls: can't open '/proc/25822/fd': No such file or directory </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">ls: can't open '/proc/25823/fd': No such file or directory </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">lrwx------    1 root     root            64 Jan  2 07:39 2 -&gt; /dev/pts/0 </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">lrwx------    1 root     root            64 Jan  2 07:39 3 -&gt; socket:[860] </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">lrwx------    1 root     root            64 Jan  2 07:39 4 -&gt; socket:[1161] </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">  </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">/proc/757/fd: </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">dr-x------    2 root     root             0 Jan  2 07:39 . </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">dr-xr-xr-x    6 root     root             0 Jan  1 01:00 .. </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">lr-x------    1 root     root            64 Jan  2 07:39 0 -&gt; /dev/null </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">lrwx------    1 root     root            64 Jan  2 07:39 1 -&gt; /dev/console </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">lrwx------    1 root     root            64 Jan  2 07:39 2 -&gt; /dev/console </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">lrwx------    1 root     root            64 Jan  2 07:39 3 -&gt; socket:[853] </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">  </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">Process no:757 uses sends or receives the packet types with 853: </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">757 root      9392 S    l2fxd -v4 </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">------------------------------------------------------------------------------------------------------------ </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">TCPDUMP </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">----------------------------------------------- </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">Compiling TCPdump and libpcap </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">----------------------------- </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">Libpcap </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">-------- </span></span><br/>
</div><br/>
<div style="text-align: left"><a href="mailto:air-builder@e9132aabc75b:/project/tcpdump/libpcap-1.7.4$"><span style="font-size: 11pt"><span style="font-family: Calibri">air-builder@e9132aabc75b:/project/tcpdump/libpcap-1.7.4$</span></span></a><span style="font-size: 11pt"><span style="font-family: Calibri">&nbsp;PATH=$PATH:/opt/air_toolchains/products/Air4920m/bin/ ./configure --host=arm-linux --with-pcap=linux </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">make </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">  </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">TcpDump </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">-------------- </span></span><br/>
</div><br/>
<div style="text-align: left"><a href="mailto:air-builder@e9132aabc75b:/project/tcpdump/tcpdump-4.7.4$"><span style="font-size: 11pt"><span style="font-family: Calibri">air-builder@e9132aabc75b:/project/tcpdump/tcpdump-4.7.4$</span></span></a><span style="font-size: 11pt"><span style="font-family: Calibri">&nbsp;PATH=$PATH:/opt/air_toolchains/products/Air4920m/bin/ ./configure --host=arm-linux                   </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">  </span></span><br/>
</div><br/>
<div style="text-align: left"><a href="mailto:air-builder@e9132aabc75b:/project/tcpdump/tcpdump-4.7.4$"><span style="font-size: 11pt"><span style="font-family: Calibri">air-builder@e9132aabc75b:/project/tcpdump/tcpdump-4.7.4$</span></span></a><span style="font-size: 11pt"><span style="font-family: Calibri">&nbsp;PATH=$PATH:/opt/air_toolchains/products/Air4920m/bin/ make                                </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">  </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">check file </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">------------ </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">file tcpdump </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">readelf -a tcpdump </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">readelf -a tcpdump|grep Shared </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">  </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">Strip the file </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">----------------- </span></span><br/>
</div><br/>
<div style="text-align: left"><a href="mailto:air-builder@8307c989a41c:/project/tcpdump/tcpdump-4.7.4$"><span style="font-size: 11pt"><span style="font-family: Calibri">air-builder@8307c989a41c:/project/tcpdump/tcpdump-4.7.4$</span></span></a><span style="font-size: 11pt"><span style="font-family: Calibri">&nbsp;/opt/air_toolchains/products/Air4920m/bin/arm-linux-strip -s tcpdump </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">  </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">  </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri">wlan.fc.type_subtype == 0x000b ||  wlan.fc.type_subtype==1 ||  wlan.fc.type_subtype==2 ||wlan.fc.type_subtype == 0x0002 || wlan.fc.type_subtype == 0x0003 || eapol ||  wlan.fc.type_subtype==10 </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-size: 11pt"><span style="font-family: Calibri"> </span></span><br/>
</div></body></html>