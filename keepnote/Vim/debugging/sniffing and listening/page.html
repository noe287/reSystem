<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Sniffing and Listening</title>
</head><body><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">SNIFFing </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">--------------------------------------------------------------------------------------------------------------- </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">tcpdump -vvv -i br0 ether proto 0x7380 </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">tcpdump -vvv -i wds1.2 ether proto 0x7380 </span></span><br/>
<span style="font-size: 11pt"><span style="font-family: Calibri"><br/>
</span></span><span style="font-size: 11pt"><span style="font-family: Calibri">tcpdump -vvv -i eth0 ether proto 0x7380 </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">  </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">Mcap sniffing from inside 4920 </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">--------------------------------------------------------------------------------------------------------------- </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">/mkap.4920 -i eth0 </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">nc 192.168.2.102 54321|wireshark -kSli - </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">iperf -s -u -B 224.0.22.2 </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">cat /proc/igmp_snoop_info </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">  </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">How to RUN on the device and PC or linux </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">--------------------------------------------------------------------------------------------------- </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">On 4920 </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">-------- </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">./tcpdump.4920 -i eth0 -w -| nc -l -p 9999 </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">  </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">On the PC </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">---------------------------------------------------------------- </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">nc 192.168.2.64 9999 &gt; dump.pcap </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">  </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">On the PC to read the dump.pcap </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">------------------------------------------------------------------ </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">tcpdump -r dump.pcap igmp or arp </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">  </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">or use wireshark or tshark </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">  </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">nc -l 9999|wireshark -kSli - </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">----------------------------------------------------------------------------- </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">Just FILE TRANSFER </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">----------------------------------------------------------------------------------------- </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">PC to Air4920 </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">------------------------------------------------------------------------------------------- </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">nc 192.168.2.77 9999 &gt; a.bin </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">nc -l 9999 &lt; tcpdump.4920 </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">  </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">--------------------------------------------------------------------------------------------------- </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">  </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">  </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">  </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">Air5760 as a wireless SNIFFER </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">------------------------------------------------------------------------------------------------------- </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">On the HOST PC while SUPERUSER: </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">------------------ </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">nc -l -p 9999 | wireshark -k -S -l -i - &amp; </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">  </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">On 5760 </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">------------------- </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">set_config wireless-1 channel 36 </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">wl -i wl1 monitor 3   </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">ifconfig radiotap1 up  </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">tcpdump -i radiotap1 -n -w - | nc 192.168.2.77 9999 &amp; </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">  </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">  </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">set_config wireless-0 channel 13 </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">wl -i wl0 monitor 3   </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">ifconfig radiotap0 up  </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">tcpdump -i radiotap0 -n -w - | nc 192.168.2.77 9999 &amp; </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">  </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">--------------------------------------------------------------------------------------------------- </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">  </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">PACKET TRACKING </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">------------------------------------------------------------------------------------------------------------ </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">cat /proc/net/packet  </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">sk       RefCnt Type Proto  Iface R Rmem   User   Inode </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">ce250400 3      2    0800   5     1 0      0      6580382 </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">ceeff800 3      3    886c   5     1 0      0      5130   </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">ceeff600 3      3    888e   5     1 0      0      5126   </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">ceeff400 3      3    888e   7     1 0      0      5125   </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">ceeff200 3      3    888e   5     1 0      0      5120   </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">cdb6b800 3      3    886c   5     1 0      0      5093   </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">cec72000 3      3    888e   5     1 0      0      5089   </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">ceccb200 3      3    888e   8     1 0      0      5088   </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">cdb55000 3      2    0806   5     1 122688 0      3458   </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">ce240c00 3      3    7379   5     1 0      0      1996   </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">cecc2e00 3      3    88d9   5     1 0      0      895    </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">ceea2000 3      3    7679   5     1 0      0      853    </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">cecc2000 3      3    7679   5     1 0      0      832    </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">cecc2a00 3      3    7679   5     1 0      0      831   </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">  </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">------------------------------------------------------------------------------------------------------------ </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">ls /proc/*/fd -al|grep 853 -B 10 </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">ls: /proc/25820/fd/3: cannot read link: No such file or directory </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">ls: can't open '/proc/25822/fd': No such file or directory </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">ls: can't open '/proc/25823/fd': No such file or directory </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">lrwx------    1 root     root            64 Jan  2 07:39 2 -&gt; /dev/pts/0 </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">lrwx------    1 root     root            64 Jan  2 07:39 3 -&gt; socket:[860] </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">lrwx------    1 root     root            64 Jan  2 07:39 4 -&gt; socket:[1161] </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">  </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">/proc/757/fd: </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">dr-x------    2 root     root             0 Jan  2 07:39 . </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">dr-xr-xr-x    6 root     root             0 Jan  1 01:00 .. </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">lr-x------    1 root     root            64 Jan  2 07:39 0 -&gt; /dev/null </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">lrwx------    1 root     root            64 Jan  2 07:39 1 -&gt; /dev/console </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">lrwx------    1 root     root            64 Jan  2 07:39 2 -&gt; /dev/console </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">lrwx------    1 root     root            64 Jan  2 07:39 3 -&gt; socket:[853] </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">  </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">Process no:757 uses sends or receives the packet types with 853: </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">757 root      9392 S    l2fxd -v4 </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">------------------------------------------------------------------------------------------------------------ </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">TCPDUMP </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">----------------------------------------------- </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">Compiling TCPdump and libpcap </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">----------------------------- </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">Libpcap </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">-------- </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt"><a href="mailto:air-builder@e9132aabc75b:/project/tcpdump/libpcap-1.7.4$">air-builder@e9132aabc75b:/project/tcpdump/libpcap-1.7.4$</a>&nbsp;PATH=$PATH:/opt/air_toolchains/products/Air4920m/bin/ ./configure --host=arm-linux --with-pcap=linux </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">make </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">  </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">TcpDump </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">-------------- </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt"><a href="mailto:air-builder@e9132aabc75b:/project/tcpdump/tcpdump-4.7.4$">air-builder@e9132aabc75b:/project/tcpdump/tcpdump-4.7.4$</a>&nbsp;PATH=$PATH:/opt/air_toolchains/products/Air4920m/bin/ ./configure --host=arm-linux                   </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">  </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt"><a href="mailto:air-builder@e9132aabc75b:/project/tcpdump/tcpdump-4.7.4$">air-builder@e9132aabc75b:/project/tcpdump/tcpdump-4.7.4$</a>&nbsp;PATH=$PATH:/opt/air_toolchains/products/Air4920m/bin/ make                                </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">  </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">check file </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">------------ </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">file tcpdump </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">readelf -a tcpdump </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">readelf -a tcpdump|grep Shared </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">  </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">Strip the file </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">----------------- </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt"><a href="mailto:air-builder@8307c989a41c:/project/tcpdump/tcpdump-4.7.4$">air-builder@8307c989a41c:/project/tcpdump/tcpdump-4.7.4$</a>&nbsp;/opt/air_toolchains/products/Air4920m/bin/arm-linux-strip -s tcpdump </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">  </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">  </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt">wlan.fc.type_subtype == 0x000b ||  wlan.fc.type_subtype==1 ||  wlan.fc.type_subtype==2 ||wlan.fc.type_subtype == 0x0002 || wlan.fc.type_subtype == 0x0003 || eapol ||  wlan.fc.type_subtype==10 </span></span><br/>
</div><br/>
<div style="text-align: left"><span style="font-family: Calibri"><span style="font-size: 11pt"> </span></span><br/>
</div></body></html>